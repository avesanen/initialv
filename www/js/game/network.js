// Generated by CoffeeScript 1.6.2
/*
# Browser side networking game code
*/


(function() {
  define(["jquery", "exports", "socket.io"], function($, exports, io) {
    var socket;
    socket = io.connect();
    exports.playerUuid = null;
    exports.init = function(local, remote, map) {
      socket.emit("request_map_data");
      socket.emit("request_player_data");
      socket.on("map_data", function(data) {
        return map.loadMap(JSON.parse(data));
      });
      socket.on("player_data", function(data) {
        var player;
        player = JSON.parse(data);
        local[player.uuid] = player;
        return exports.playerUuid = player.uuid;
      });
      socket.on("game_sync", function(data) {
        var i, remoteobjs, _results;
        remoteobjs = JSON.parse(data);
        _results = [];
        for (i in remoteobjs) {
          if (remoteobjs.hasOwnProperty(i)) {
            _results.push(remote[i] = remoteobjs[i]);
          } else {
            _results.push(void 0);
          }
        }
        return _results;
      });
      socket.on("event", function(event) {});
      return setInterval((function() {
        return socket.emit("client_object_sync", JSON.stringify(local));
      }), 50);
    };
  });

}).call(this);
