<!doctype html>
<html xmlns="http://www.w3.org/1999/html" xmlns="http://www.w3.org/1999/html">
<head>
    <title>index</title>
    <script src="http://code.jquery.com/jquery-latest.js" type="text/javascript"></script>
    <script src="/socket.io/socket.io.js"></script>
</head>
<body>

<h2>InitialV</h2>
<div style="position: relative; border-style: solid; border-width: 1px; width: 640px; height: 480px;">
    <canvas id="layer1" width="640" height="480"
            style="position: absolute; left: 0; top: 0; z-index: 0;"></canvas>
    <canvas id="layer2" width="640" height="480"
            style="position: absolute; left: 0; top: 0; z-index: 1;"></canvas>
</div>
Use arrow keys to move map.

<script>
    // Quick and dirty map drawing with test map image.
    var map = function() {
        var that = this;
        var canvas = document.getElementById('layer1');
        var context = canvas.getContext('2d');
        var imageObj = new Image();
        this.x = 0;
        this.y = 0;
        imageObj.onload = function() {
            setInterval(function(){
            	context.moveTo(0,0);
                //if(keyStates[39]) that.x++;
                //if(keyStates[37]) that.x--;
                //if(keyStates[38]) that.y--;
                //if(keyStates[40]) that.y++;
                context.drawImage(imageObj, -that.x, -that.y);
            },1/10);
        };
        imageObj.src = "img/test.png";
    };

	var ship = function () {
		this.angle = 2;
		this.x = 100;
		this.y = 100;
		this.dx = 0;
		this.dy = 0;
		setInterval(function(){
            if(keyStates[37]) {
              	this.angle-=0.02;
               	//alert(this.angle);
            }
            if(keyStates[39]) {
               	this.angle+=0.02;
               	//alert(this.angle);
            }
            if(keyStates[38]) {
            	this.dx += Math.sin(this.angle)/500;
            	this.dy -= Math.cos(this.angle)/500;
            }
            
            //this.dy = this.dy + 0.002; // gravitation
            this.y += this.dy;
            this.x += this.dx;
            
            var canvas = document.getElementById('layer1');
    		var ctx = canvas.getContext('2d');
    		ctx.save(); // we want to rotate only the ship
    		ctx.translate(this.x,this.y);
    		ctx.beginPath();
    		ctx.strokeStyle = '#00ff00';
    		ctx.lineWidth = 2;
    		ctx.rotate(this.angle);
    		ctx.moveTo(0,-8);
    		ctx.lineTo(-8,+8);
    		ctx.lineTo(+8,+8);
    		ctx.closePath();
    		ctx.stroke();
    		ctx.restore(); // restore rotation etc.
        },1/10);
	};

    var m = map();
    var s = ship();
    
    /*function canvasRefresh()
    {
    alert("moi");
    }
    
    setinterval(canvasRefresh(), 1/1000);*/

    // Keyboard states
    var keyStates = {};
    var keyBuffer = [];
    function onKeyboard(e) {
        if(e.type == "keydown") {
            if(!keyStates[e.keyCode]) {
                keyStates[e.keyCode] = true;
                keyBuffer.push(e.keyCode);
            }
        }
        if(e.type == "keyup") {
            if(keyStates[e.keyCode]){
                keyStates[e.keyCode] = false;
            }
        }
    }

    $(window).bind('keydown',function(e){
        onKeyboard(e);
    });

    $(window).bind('keyup',function(e){
        onKeyboard(e);
    });

</script>

<script>
    var socket = io.connect('http://localhost');
    socket.on('newobject', function (data) {
    });
</script>

</body>

</html>
